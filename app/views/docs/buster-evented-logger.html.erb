<h1><code>buster.eventedLogger</code></h1>
<dl>
  <dt>Version</dt>
  <dd>0.2.0 <span class="date">(2011-03-14)</span></dd>
  <dt>Module</dt>
  <dd><code>require("buster-evented-logger");</code></dd>
  <dt>In browsers</dt>
  <dd><code>buster.eventedLogger;</code></dd>
</dl>
<p>
  A simple <%= m("eventedLogger", "evented console logger") %>. In contrast to
  typical loggers, <strong>buster-evented-logger</strong> does not print
  directly to an output stream. Instead, log messages are emitted as events,
  decoupling the visualization/persistence of log messages.
</p>
<p>
  <strong>buster-evented-logger</strong> supports setting a log level to filter
  messages, logging arbitrary many arguments with one call, customizable
  formatting of objects and even custom log level hierarchies.
</p>
<div class="section">
  <h2 id="<%= id('events') %>">Events</h2>
  <%= event("log", [[:envelope, "#envelope"]]) %>
  <p>
    Emitted every time data is logged and is allowed by the current log
    level. Any messages logged to the current level or a higher priority level
    will be emitted.
  </p>
</div>
<div class="section">
  <h2 id="<%= id('methods') %>">Methods</h2>
  <div class="intro">
    <p>
      Parts of the logger API is dynamically assembled by the <%=l "create" %>
      method. The API documentation also describes the methods dynamically
      generated by this method in the default setup.
    </p>
  </div>
  <h3 id="<%= id('create') %>" data-title="+create([options])+"><code>create([<%=anchor "options" %>])</code></h3>
  <p>
    Creates a new logger. The default behavior is to create a logger with the
    levels/methods <%=l "error" %>, <%=l "warn" %>, <%=l "log" %> and
    <%=l "debug" %>. <code>"debug"</code> is the default log level, meaning that
    all messages are emitted.
  </p>
  <p>
    The <%=l "options" %> argument can be used to control what logging methods
    the logger should have, default logging level and formatting method.
  </p>
  <h4>Typical usage</h4>
  <pre><code>var logger = buster.eventedLogger.create();

logger.on("log", function (msg) {
    console.log("[" + msg.level.toUpperCase() + "] " + msg.message);
});

logger.warn("Watch it!");
logger.log([], 42, {});

// Prints the following to stdout:
// [WARN] Watch it!
// [LOG] [] 42 {}</code></pre>
  <h4>Setting the default level</h4>
  <pre><code>var logger = buster.eventedLogger.create({ level: "warn" });

logger.on("log", function (msg) {
    console.log("[" + msg.level.toUpperCase() + "] " + msg.message);
});

logger.warn("Watch it!");
logger.log([], 42, {});

// Will not print the log message, so stdout looks like:
// [WARN] Watch it!</code></pre>
  <h4 id="<%= id('custom') %>">Creating custom loggers</h4>
  <p>
    Custom levels should be passed ordered from highest to lowest severity. The
    generated methods will pass through messages if the current log level is set
    to either the same level as the message or one in the lower indexes of the
    levels array.
  </p>
  <p>
    When you create a logger with customized levels, the default log level will
    be set to the most permissive one, i.e. the last level in the array.
  </p>
  <pre><code>var logger = buster.eventedLogger.create({
    levels: ["nuclear", "eerie", "info", "debug"]
});

logger.level == "debug"; //=> true
typeof logger.error == "undefined";

logger.nuclear("This is NOT good");</code></pre>
  <p>
    If you want the logger to have some other default log level than the most
    permissive one, include <%=anchor "<code>level</code>", "options" %>:
  </p>
  <pre><code>var logger = buster.eventedLogger.create({
    levels: ["nuclear", "eerie", "info", "debug"],
    level: "eerie"
});

logger.info("This is NOT good"); // Won't be emitted</code></pre>
  <h3 id="<%= id('format') %>"><code>format(object)</code></h3>
  <p>
    Formats a logged object. This function is called once for each argument
    passed to a logger method. The default implementation serializes objects
    through <a href="https://developer.mozilla.org/en/json">JSON.stringify</a>.
    Functions and primitives are converted to strings by way of their
    <code>toString</code> methods.
  </p>
  <p>
    The method can be overridden to provide more powerful formatting of objects
    such as functions and problematic host objects.
  </p>
  <p>
    <%=m "test" %> provides more readable formatting through the <%=m "format" %>
    module. There is basically three ways to achieve this:
  </p>
  <h4>Override the original method</h4>
  <pre><code>buster.eventedLogger.format = buster.format.ascii;</code></pre>
  <h4>Override the method on an instance</h4>
  <pre><code>var logger = buster.eventedLogger.create();
logger.format = buster.format.ascii;</code></pre>
  <h4>Pass the formatter to <%=l "create" %></h4>
<pre><code>var logger = buster.eventedLogger.create({
    logger: buster.format.ascii
});</code></pre>
  <h3 id="<%= id('error') %>"><code>error(message1[, message2, ...])</code></h3>
  <p>
    Logs messages with the <code>"error"</code> level. Messages will always be
    emitted from the logger unless the log level has been set to a non-existent
    level.
  </p>
  <pre><code>var logger = buster.eventedLogger.create();
// ...

logger.error("Something went wrong", myObjToDebug);</code></pre>
  <p>
    <strong>NB!</strong> If you have created a logger with custom levels,
    the <code>error</code> method will not exist unless you explicitly included
    it.
  </p>
  <h3 id="<%= id('warn') %>"><code>warn(message1[, message2, ...])</code></h3>
  <p>
    Logs messages with the <code>"warn"</code> level. This message will be
    emitted from the logger unless its level is set to <code>"error"</code> or a
    non-existent level.
  </p>
  <pre><code>var logger = buster.eventedLogger.create();
// ...

logger.warn("Something fishy?", myObjToDebug);</code></pre>
  <p>
    <strong>NB!</strong> If you have created a logger with custom levels,
    the <code>warn</code> method will not exist unless you explicitly included
    it.
  </p>
  <h3 id="<%= id('log') %>"><code>log(message1[, message2, ...])</code></h3>
  <p>
    Logs messages with the <code>"log"</code> level. This message will be
    emitted from the logger if its level is set to <code>"log"</code>
    or <code>"debug"</code> (default).
  </p>
  <pre><code>var logger = buster.eventedLogger.create();
// ...

logger.log("Here's an object", myObjToDebug);</code></pre>
  <p>
    <strong>NB!</strong> If you have created a logger with custom levels,
    the <code>log</code> method will not exist unless you explicitly included it.
  </p>
  <h3 id="<%= id('debug') %>"><code>debug(message1[, message2, ...])</code></h3>
  <p>
    Logs messages with the <code>"debug"</code> level. This message will only be
    emitted from the logger if its level is set to <code>"debug"</code>
    (default).
  </p>
  <pre><code>var logger = buster.eventedLogger.create();
// ...

logger.debug("What's going on??", myObjToDebug);</code></pre>
  <p>
    <strong>NB!</strong> If you have created a logger with custom levels,
    the <code>debug</code> method will not exist unless you explicitly included
    it.
  </p>
</div>
<div class="section">
  <h2 id="<%= id('propeties') %>">Properties</h2>
  <%= property("level", "\"debug\"") %>
  <p>
    Set the level of the logger, silence all messages for less severe
    levels. The default level is the most permissive one - <code>"debug"</code>
    when not using custom levels.
  </p>
</div>
<div class="section">
  <h2 id="<%= id('supporting-objects') %>">Supporting objects</h2>
  <h3 id="<%= id('envelope') %>"><code>envelope</code></h3>
  <p>
    An object representing a logged message. Contains two properties:
  </p>
  <dl class="properties">
    <dt><code>level</code></dt>
    <dd>The log level as a lower case string, e.g. <code>"debug"</code></dd>
    <dt><code>message</code></dt>
    <dd>
      A formatted log message, containing all arguments passed to the log method
      joined by a single blank space.
    </dd>
  </dl>
  <h3 id="<%= id('options') %>"><code>options</code></h3>
  <p>
    Options passed to <%=l "create" %>.
  </p>
  <dl class="properties">
    <dt><code>level</code></dt>
    <dd>
      The default log level, i.e. the minimum required level the logger will
      emit events for. Default value is <code>"debug"</code>, i.e. all messages.
    </dd>
    <dt><code>levels</code></dt>
    <dd>
      An array of levels the logger supports. Default is
      <code>["error", "warn", "log", "debug"]</code>. Each string in this array
      names methods created on the logger.
    </dd>
    <dt><code>formatter</code></dt>
    <dd>The function that should format arguments. See <%=l "format" %>.</dd>
  </dl>
</div>

